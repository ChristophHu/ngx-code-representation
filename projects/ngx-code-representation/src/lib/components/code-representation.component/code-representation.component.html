@defer (when gist$) {
  @if ((gist$ | async); as gist) {
    <div class="absolute inset-0 flex flex-col">
      <div class="sticky top-0 z-10 w-full flex items-center justify-between border-b border-borderline bg-background">
        <ul class="relative w-auto list-none flex flex-wrap scrollbar-hide">
          @if (gist) {
            <li #tabItem class="preview-tab mb-2 px-2 inline-block cursor-pointer" [class.active]="activeView() === 1" (click)="selectView(1)" (mouseenter)="onTabHover(0)" (mouseleave)="onTabLeave()">
              <a class="flex items-center">
                <div class="h-5 w-5 mr-2">
                  <ngx-icons name="eye"></ngx-icons>
                </div>
                <span>Preview</span>
              </a>
            </li>
          }
          @if (gist.file && gist.file.length > 0) {
            @for (file of gist.file; track file.filename; let i = $index) {
              <li #tabItem class="mb-2 px-2 inline-block cursor-pointer" [class.active]="file_index === i && activeView() === 0" (click)="selectFile(i); selectView(0)" (mouseenter)="onTabHover(gist ? i + 1 : i)" (mouseleave)="onTabLeave()">
                <a class="flex items-center">
                  <div class="h-5 w-5 mr-2">
                    <ngx-icons [name]="'file-type-' + file.language"></ngx-icons>
                  </div>
                  <span>{{ file.filename }}</span>
                </a>
              </li>
            }
          }
          <hr class="absolute bottom-0 h-0.5 bg-accent border-0 rounded-full transition-all duration-300 ease-in-out" [style.left.px]="indicatorLeft()" [style.width.px]="indicatorWidth()">
        </ul>
      </div>

      <div class="flex-1 overflow-auto relative">
        
        @if (activeView() === 0) {
          @if ((file$ | async); as file) {
            <code-renderer [file]="file"></code-renderer>
          }
        }

        @if (activeView() === 1) {
          <div class="preview-container">
            <preview-renderer [gist]="gist"></preview-renderer>
          </div>
        }
      </div>
    </div>
  }

} @placeholder {
  <div class="absolute flex h-12 w-full justify-center inset-0 text-gray-400">
    <div class="flex flex-col items-center text-lg">
      <div class="w-8 h-8 fill-blue-600 text-gray-200 animate-spin">
        <ngx-icons class="" name="spinner"></ngx-icons>
      </div>
      <span class="mt-2">Pr√§sentation wird vorbereitet...</span>
    </div>
  </div>
} @loading {
  <div class="absolute flex h-12 w-full justify-center inset-0 text-gray-400">
    <div class="flex flex-col items-center text-lg">
      <div class="w-8 h-8 fill-blue-600 text-gray-200 animate-spin">
        <ngx-icons class="" name="spinner"></ngx-icons>
      </div>
      <span class="mt-2">Daten werden geladen...</span>
    </div>
  </div>
} @error {
  <div class="absolute flex h-12 w-full justify-center inset-0 text-gray-400">
    <div class="flex flex-col items-center text-lg">
      <div class="w-8 h-8 mr-2">
        <ngx-icons class="stroke-2 stroke-current" name="alert-triangle"></ngx-icons>
      </div>
      <span>Es kam zu einem unerwarteten Fehler!</span>
    </div>
  </div>
}